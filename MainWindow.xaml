<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="ChatBox.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="ChatBox">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid Padding="16" RowDefinitions="Auto, * , Auto">
        <!-- 🧠 Tiêu đề -->
        <TextBlock 
            Text="💬 ChatBox AI"
            FontSize="22"
            FontWeight="SemiBold"
            HorizontalAlignment="Center"
            Margin="0,10,0,10"
            Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>

        <!-- 📜 Khu vực hiển thị tin nhắn -->
        <ListView 
            x:Name="ChatListView"
            Grid.Row="1"
            ItemsSource="{x:Bind _messages}"
            Margin="0,10"
            IsItemClickEnabled="False"
            SelectionMode="None"
            ScrollViewer.VerticalScrollBarVisibility="Auto">

            <ListView.ItemTemplate>
                <DataTemplate x:DataType="x:String">
                    <Border 
                        Margin="4"
                        Padding="10"
                        CornerRadius="8"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                        <TextBlock 
                            Text="{Binding}"
                            TextWrapping="WrapWholeWords"
                            FontSize="14"
                            Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    </Border>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- ✍️ Ô nhập và nút gửi -->
        <StackPanel 
            Grid.Row="2"
            Orientation="Horizontal"
            Spacing="8"
            VerticalAlignment="Bottom">

            <TextBox 
                x:Name="InputTextBox"
                PlaceholderText="Type a message or Ngrok link..."
                Width="380"
                AcceptsReturn="False"
                KeyDown="InputTextBox_KeyDown"
                Margin="0,0,4,0"/>

            <Button 
                x:Name="SendButton"
                Content="Send"
                Width="80"
                Click="SendButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
